{{- define "funds" -}}
  <mj-table>
    <tr>
      <th width="140px">ISIN</th>
      <th>Libellé</th>
      <th width="80px">Score</th>
    </tr>

    {{- range $index, $fund := . -}}
      <tr {{- if odd $index }} style="background-color: #e1e1e8"{{- end -}}>
        <td>
          <a href="https://funds.vibioh.fr/?isin={{ $fund.Isin }}" rel="noopener noreferrer" target="_blank">{{- $fund.Isin -}}</a>
        </td>
        <td>{{- $fund.Label -}}</td>
        <td>{{ $fund.Score }}</td>
      </tr>
    {{- end -}}
  </mj-table>
{{- end -}}

<mjml>
  <mj-head>
    <mj-title>Alerte Funds</mj-title>
    <mj-preview>Nouveaux fonds qui dépassent leur seuil</mj-preview>
  </mj-head>

  <mj-body>
    <mj-container>
      <mj-section background-color="#3a3a3a">
        <mj-column>
          <mj-text align="center" color="#f8f8f8" padding="0" font-size="24px" font-weight="bold">Funds</mj-text>
        </mj-column>
      </mj-section>

      <mj-section>
        <mj-column>
          <mj-text>Bonjour,</mj-text>

          {{- if len .AboveFunds -}}
            <mj-text color="#4cae4c">Les fonds suivants viennent de dépasser le score de <strong>{{ .Score }}</strong>.</mj-text>
            {{- template "funds" .AboveFunds -}}
          {{— end -}}

          {{- if len .BelowFunds -}}
            <mj-text color="#d43f3a">Les fonds suivants viennent de repasser sous leur seuil initial d'alerte.</mj-text>
            {{ template "funds" .BelowFunds -}}
          {{— end -}}

          <mj-text>Pour plus d'informations, n'hésitez pas à consulter <a href="https://funds.vibioh.fr/?o=score" rel="noopener noreferrer" target="_blank">notre site</a></mj-text>

          <mj-text>
              Bonne journée,
              <br />
              A bientôt,
          </mj-text>
          <mj-text>
              Funds App - powered by <a href="https://vibioh.fr" rel="noopener noreferrer" target="_blank">ViBiOh</a>
          </mj-text>

        </mj-column>
      </mj-section>
    </mj-container>
  </mj-body>
</mjml>
